#+TITLE: Testing en Javascript

* Definiciones

Test end-to-end: prueban sobre el DOM de la web definitiva.

* Herramientas

#+BEGIN_SRC js
  {
    "name": "js-testing-workshop",
    "version": "0.0.0",
    "devDependencies": {
      "chai": "^1.9.1",
      "chai-jquery": "^1.2.3",
      "karma": "^0.12.16",
      "karma-chai": "^0.1.0",
      "karma-chrome-launcher": "^0.1.4",
      "karma-html2js-preprocessor": "^0.1.0",
      "karma-mocha": "^0.1.4",
      "karma-sinon": "^1.0.3",
      "mocha": "^1.20.1",
      "sinon": "^1.10.2"
    }
  }
#+END_SRC

  - =chai=: aserciones
  - =chai-jquery=: syntax sugar para chai
  - =sinon=: mocks
  - =mocha=: bloques sintácticos para TDD y BDD

* Configuración de Karma

  Ejecutamos el wizard de Karma

  #+BEGIN_SRC shell-script
    $ ./node_modules/karma/bin/karma init
    
    Which testing framework do you want to use ?
    Press tab to list possible options. Enter to move to the next question.
    > mocha
    
    Do you want to use Require.js ?
    This will add Require.js plugin.
    Press tab to list possible options. Enter to move to the next question.
    > no
    
    Do you want to capture any browsers automatically ?
    Press tab to list possible options. Enter empty string to move to the next question.
    > Chrome
    >
    
    What is the location of your source and test files ?
    You can use glob patterns, eg. "js/*.js" or "test/**/*Spec.js".
    Enter empty string to move to the next question.
    > test/**/*Spec.js
    WARN [init]: There is no file matching this pattern.
    
    >
    
    Should any of the files included by the previous patterns be excluded ?
    You can use glob patterns, eg. "**/*.swp".
    Enter empty string to move to the next question.
    >
    
    Do you want Karma to watch all the files and run the tests on change ?
    Press tab to list possible options.
    > yes
    
    
    Config file generated at "/home/mgdelacroix/dev/kaleidos-summer-mondays/testing-en-javascript/karma.conf.js".
  #+END_SRC

  Editamos el fichero =karma.conf.js= y añadimos algunos frameworks:

  #+BEGIN_SRC js
    frameworks: ['mocha', 'chai', 'sinon']
  #+END_SRC

  Modificamos el bloque =file= para que quede así:

  #+BEGIN_SRC js
    files: [
        'test/**/*Spec.js',
        'spec/**/*.js'
    ],
  #+END_SRC
